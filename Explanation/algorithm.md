# الگوریتم ماشین بردار پشتیبان ( SVM )

ماشین بردار پشتیبان یا SVM نوعی الگوریتم یادگیری ماشین از نوع نظارت شده است که برای حل مسائل طبقه‌بندی و رگرسیون مورد استفاده قرار می‌گیرد. به‌طور ویژه، الگوریتم SVM در حل مسائل طبقه‌بندی دودویی که داده‌های دیتاست به دو گروه مجزا دسته‌بندی می‌شوند کاربرد دارد. هدف از به‌کارگیری این الگوریتم، پیدا کردن بهترین خط یا به اصطلاح «مرز تصمیمی» است که بتواند نقاط داده گرو‌ه‌ها یا کلاس‌های مختلف را از یک‌دیگر جدا کند. مرزی که هنگام کار با تعداد زیادی از ویژگی‌ها، «ابَر صفحه»‌ (Hyperplane) نامیده می‌شود. هر چه فاصله یا «حاشیه» بیشتری میان ابر صفحه و نزدیک‌ترین نقاط داده از هر کلاس وجود داشته باشد، یعنی دسته‌بندی بهتری توسط الگوریتم SVM صورت گرفته است.

# انواع SVM 

 ## 1.خطی

الگوریتم SVM از یک مرز تصمیم خطی برای جدا کردن نقاط داده کلاس‌های مختلف از یک‌دیگر استفاده می‌کند. این الگوریتم زمانی کاربرد دارد که داده‌ها به‌طور خطی قابل جداسازی باشند. به بیان ساده‌تر، باید بتوان با تنها یک خط راست در فضای ۲ یا چند بعدی، داده‌ها را در کلاس‌های مجزایی طبقه‌بندی کرد. ابر صفحه‌ای که فاصله میان کلاس‌ها را به حداکثر برساند همان مرز تصمیم است.

 ## 2.غیرخطی

زمانی از نوع غیر خطی الگوریتم SVM استفاده می‌شود که نتوانیم داده‌ها را با یک خط راست به دو کلاس مختلف تقسیم کنیم. در SVM غیر خطی، ابتدا داده‌های ورودی از طریق توابعی با عنوان «توابع کِرنل» (Kernel Functions) به فضایی با ابعاد بالاتر نگاشت شده و سپس به‌طور خطی از هم جدا می‌شوند. برای ایجاد مرز تصمیم غیر خطی در این فضای ویژگی تغییر یافته، از یک SVM خطی استفاده می‌شود.

# مفاهیم مهم در SVM

«ابر صفحه» (Hyperplane): مرز تصمیمی که برای جداسازی نمونه‌های چند کلاس مختلف در فضای ویژگی مورد استفاده قرار می‌گیرد. برای مثال در طبقه‌بندی خطی، ابر صفحه برابر با معادله خطی:

## wx+b=0

«بردارهای پشتیبان» (Support Vectors): نزدیک‌ترین نقاط داده به ابر صفحه را گویند و نقش بسیار مهمی در تعیین حاشیه و ابر صفحه دارند.

«حاشیه» (Margin): فاصله میان بردار پشتیبان و ابر صفحه است. اولویت الگوریتم ماشین بردار پشتیبان، بیشینه‌سازی حاشیه است. حاشیه بیشتر، عملکرد بهتر الگوریتم طبقه‌بندی را نشان می‌دهد.

«کرنل»‌ (Kernel): تابع ریاضیاتی که در الگوریتم SVM و برای نگاشت داده‌های ورودی به فضای ویژگی با ابعاد بالا مورد استفاده قرار می‌گیرد. با این کار، حتی اگر نتوان نقاط داده را به شکل خطی از یک‌دیگر جدا کرد، مرز تصمیم یا ابر صفحه به راحتی پیدا می‌شود. برخی از رایج‌ترین کرنل‌ها عبارت‌اند از: خطی، چند جمله‌ای، «تابع شعاعی پایه» (Radial Basis Function | RBF) و سیگوئید.

«حاشیه سخت»‌ (Hard Margin): ابر صفحه‌ای که تمام نقاط داده را بدون خطا در کلاس‌های مجزا دسته‌بندی می‌کند.

«حاشیه نرم» (Soft Margin): وقتی داده‌ها به‌طور کامل قابل جداسازی نیستند یا دیتاست شامل نمونه‌های پرت است، الگوریتم SVM تکنیک حاشیه نرم را به‌کار می‌گیرد. به این شکل که برای هر کدام از نقاط داده، متغیری در نظر گرفته شده و بسته به مقدار متغیرها، الگوریتم اجازه دارد تا برخی از قواعد و نمونه‌های پرت را نادیده بگیرد. به بیان ساده‌تر، مصالحه‌ای شکل می‌گیرد که یک طرف آن افزایش حاشیه و طرف دیگر کاهش پایبندی به اصول طبقه‌بندی کامل است.


# نحوه کارکرد الگوریتم (با مثال)

در الگوریتم ماشین بردار پشتیبان و برای تعیین مرز جداسازی، تنها نزدیک‌ترین نقاط داده یا همان «بردارهای پشتیبان» به ابر صفحه اهمیت دارند.
اما [رگرسیون لجستیک](https://github.com/HannanehCharmgar/Logistic_Regression) ، برای تعیین دسته‌بند، به تمام نقاط داده نیاز است. یک راه‌ حل منطقی، انتخاب ابر صفحه‌ای است که بیشترین جدایی یا حاشیه را میان دو کلاس ایجاد کند.

## وقتی چند ابرصفحه داریم:
![Multiple-Hyperplanes-Separating-the-Data-from-Two-Classes-2 png](https://github.com/user-attachments/assets/75455ae9-c93a-44ae-91e5-5528c290ee1e)

بنابراین، ابر صفحه‌ای را برمی‌گزینیم که فاصله آن تا نزدیک‌ترین نقاط داده از هر طرف بیشینه باشد. در صورت وجود، چنین ابر صفحه‌ای را «حاشیه سخت» (Hard Margin) می‌نامیم. با این توصیف، در تصویر بالا ابر صفحه L2 انتخاب می‌شود.

## وقتی داده پرت داریم:

![Selecting-Hyperplane-for-Dataset-with-Outlier png](https://github.com/user-attachments/assets/13ec573d-9b1d-4265-b3ed-e12235034889)

در اینجا یک دایره آبی ( داده پرت مثال ما )در گروه قرمزها قرار گرفته است. در ابتدا شاید دسته‌بندی این دو گروه دشوار به‌نظر برسد، اما الگوریتم SVM در یادگیری ماشین، دایره آبی را نمونه پَرتی از گروه آبی در نظر گرفته و با نادیده گرفتن آن، بهترین ابر صفحه، یعنی مرز تصمیمی که بیشترین فاصله را با هر دو کلاس داشته باشد انتخاب می‌کند. به بیان ساده‌تر، می‌گوییم الگوریتم SVM نسبت به نمونه‌های پرت مقاوم است.
 در این حالت مانند حالتی که داده پرت نداریم ، ابرصفحه تعیین می شود و به چنین ابر صفحه ای حاشیه نرم (Soft Margin) گفته می شود.

![Hyperplane-which-is-the-Most-Optimized-One png](https://github.com/user-attachments/assets/780b67be-45ab-4ebe-9f80-55372e1048c1)


## اگر نتوان خطی جدا كرد چه كنيم؟

![Original-1D-Dataset-for-Classification png](https://github.com/user-attachments/assets/c229343a-3b83-442f-b3f4-7863b05a3974)

فرض کنید دیتاستی مانند آنچه در تصویر بالا مشاهده می‌شود در اختیار داریم. راه‌حل الگوریتم SVM برای حل چنین مسئله‌ای، ساخت یک متغیر جدید با استفاده از یک کرنل است. نقطه‌ای (x-i) روی محور افقی انتخاب و متناظر با آن، متغیر دیگری به عنوان تابع فاصله ( y-i )  از مبدا 0 تعریف می‌کنیم. با رسم مجموعه داده و ابر صفحه، تصویری مانند زیر به‌دست می‌آید: 

![Mapping-1D-Data-to-2D-to-Become-Able-to-Separate-the-Two-Classes png](https://github.com/user-attachments/assets/b66abb26-e8f2-4627-8594-dd2d6ce7e269)

 # کاربرد ها 

 - دسته بندی داده
 - تشخیص چهره و طبقه بندی احساسات
 - طبقه بندی متن و بازشناسی دست خط
 - تشخیص سرطان
 - 

   # مزایا
- کارایی بالا هنگامی که داده‌ها خطی باشند.
- عملکرد بهتر در ابعاد بالا
- قابلیت حل مسائل پیچده با بهره‌گیری از توابع کرنل
- مقاوم در برابر نمونه‌های پرت
- کارآمد در دسته‌بندی تصاویر
- 

# معایب

- انتخاب تابع کرنل مناسب دشوار است.
- عملکرد ضعیف در مقابل دیتاست‌های بزرگ.
- پیچیدگی در تنظیم و به تصویر کشیدن نتایج حاصل از پارامترهای الگوریتم
- 
